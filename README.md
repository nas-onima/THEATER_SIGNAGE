# ğŸ¬ THEATER SIGNAGE SYSTEM

æ˜ ç”»é¤¨å‘ã‘ã‚µã‚¤ãƒãƒ¼ã‚¸é›†ä¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡å¯¾å¿œ

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯æ˜ ç”»é¤¨ã®ãƒ‡ã‚¸ã‚¿ãƒ«ã‚µã‚¤ãƒãƒ¼ã‚¸ã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã™ã‚‹ãŸã‚ã® Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚é›†ä¸­ç®¡ç†ç”»é¢ã‹ã‚‰å„ã‚·ã‚¢ã‚¿ãƒ¼ã®ã‚µã‚¤ãƒãƒ¼ã‚¸ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åˆ¶å¾¡ã—ã€æ˜ ç”»æƒ…å ±ã®è¡¨ç¤ºãƒ»æ›´æ–°ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

### ğŸ¯ ä¸»ãªæ©Ÿèƒ½

- **æ˜ ç”»ãƒ‡ãƒ¼ã‚¿ç®¡ç†**: æ˜ ç”»ã®ç™»éŒ²ã€ç·¨é›†ã€å‰Šé™¤
- **ã‚µã‚¤ãƒãƒ¼ã‚¸é›†ä¸­ç®¡ç†**: å„ã‚·ã‚¢ã‚¿ãƒ¼ã®ã‚µã‚¤ãƒãƒ¼ã‚¸ã‚’ä¸€å…ƒç®¡ç†
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**: Socket.IO ã«ã‚ˆã‚‹å³åº§ã®ç”»é¢åæ˜ 
- **ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒˆãƒ«**: ç‰¹åˆ¥ä¸Šæ˜ ç”¨ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
- **ä¸Šæ˜ ç¨®åˆ¥è¨­å®š**: å­—å¹•ã€å¹æ›¿ã€4Kã€3D ãªã©ã®è¡¨ç¤ºè¨­å®š
- **æ¥ç¶šçŠ¶æ…‹ç›£è¦–**: ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹è¡¨ç¤º

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
THEATER_SIGNAGE/
â”œâ”€â”€ frontend/          # React.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ backend/           # Node.js + Express ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ testdata/          # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â””â”€â”€ README.md
```

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **React.js 19.1.1** - UI ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **Vite** - ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«
- **Material-UI** - UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **SWR** - ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°
- **Socket.IO Client** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
- **React Router** - ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **CSS Modules** - ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

- **Node.js** - ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ©ãƒ³ã‚¿ã‚¤ãƒ 
- **Express.js 5.1.0** - Web ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **Socket.IO** - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
- **MongoDB + Mongoose** - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **Firebase Admin** - èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- **JWT** - ãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### å‰ææ¡ä»¶

- Node.jsï¼ˆv16 ä»¥ä¸Šï¼‰
- MongoDB
- Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/nas-onima/THEATER_SIGNAGE.git
cd THEATER_SIGNAGE
```

### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd backend

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
cp .env.example .env
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ä»¥ä¸‹ã‚’è¨­å®š:
# - MONGODB_URI
# - FIREBASE_CONFIG
# - JWT_SECRET

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm start
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
cd frontend

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
```

### 4. Firebase ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. Firebase ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
2. Authentication æœ‰åŠ¹åŒ–
3. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
4. `backend/config/serviceAccountKey.json`ã«é…ç½®
5. `frontend/src/firebase.js`ã§ Firebase è¨­å®š

## ğŸ“¡ Socket.IO é€šä¿¡ãƒ•ãƒ­ãƒ¼

### ã‚·ã‚¹ãƒ†ãƒ é€šä¿¡æ¦‚è¦å›³

```mermaid
graph TB
    subgraph "ç®¡ç†ç”»é¢ (SignageManager)"
        A[ã‚µã‚¤ãƒãƒ¼ã‚¸ãƒªã‚¹ãƒˆè¡¨ç¤º]
        B[ã‚µã‚¤ãƒãƒ¼ã‚¸è©³ç´°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
        C[æ˜ ç”»ãƒ»è¨­å®šå¤‰æ›´]
    end

    subgraph "Socket.IOã‚µãƒ¼ãƒãƒ¼ (Express)"
        D[æ¥ç¶šç®¡ç†]
        E[ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†]
        F[é€šçŸ¥é…ä¿¡]
    end

    subgraph "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ (MongoDB)"
        G[SignageStatus Collection]
        H[socketId, isConnectedç®¡ç†]
    end

    subgraph "ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ (Signage)"
        I[ç”»é¢è¡¨ç¤º]
        J[Socketæ¥ç¶š]
        K[ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°]
    end

    J -->|1. signage-connect| D
    D -->|2. DBæ›´æ–°| G
    D -->|3. connection-confirmed| J
    C -->|4. API PATCH| E
    E -->|5. DBæ›´æ–°| G
    E -->|6. signage-data-updated| K
    K -->|7. ç”»é¢æ›´æ–°| I
```

### Socket.IO ã‚¤ãƒ™ãƒ³ãƒˆé€šä¿¡è¡¨

| **ã‚¤ãƒ™ãƒ³ãƒˆå**         | **æ–¹å‘**              | **é€ä¿¡è€…**      | **å—ä¿¡è€…**  | **ãƒ‡ãƒ¼ã‚¿å½¢å¼**                           | **ç”¨é€”**           |
| ---------------------- | --------------------- | --------------- | ----------- | ---------------------------------------- | ------------------ |
| `signage-connect`      | ã‚µã‚¤ãƒãƒ¼ã‚¸ â†’ ã‚µãƒ¼ãƒãƒ¼ | Signage.jsx     | server.js   | `{ theaterId: string }`                  | ã‚µã‚¤ãƒãƒ¼ã‚¸æ¥ç¶šç™»éŒ² |
| `connection-confirmed` | ã‚µãƒ¼ãƒãƒ¼ â†’ ã‚µã‚¤ãƒãƒ¼ã‚¸ | server.js       | Signage.jsx | `{ message: string, theaterId: string }` | æ¥ç¶šç¢ºèªé€šçŸ¥       |
| `signage-data-updated` | ã‚µãƒ¼ãƒãƒ¼ â†’ ã‚µã‚¤ãƒãƒ¼ã‚¸ | signage.js(API) | Signage.jsx | `SignageObject`                          | ãƒ‡ãƒ¼ã‚¿æ›´æ–°é€šçŸ¥     |
| `disconnect`           | è‡ªå‹•                  | Socket.IO       | server.js   | -                                        | åˆ‡æ–­æ¤œçŸ¥           |
| `connection-error`     | ã‚µãƒ¼ãƒãƒ¼ â†’ ã‚µã‚¤ãƒãƒ¼ã‚¸ | server.js       | Signage.jsx | `{ message: string }`                    | ã‚¨ãƒ©ãƒ¼é€šçŸ¥         |

### é€šä¿¡ãƒ•ãƒ­ãƒ¼è©³ç´°ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

| **æ®µéš** | **ç™ºç”Ÿå ´æ‰€**   | **ã‚¤ãƒ™ãƒ³ãƒˆ/ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**     | **é€ä¿¡ãƒ‡ãƒ¼ã‚¿**                            | **å—ä¿¡å´å‡¦ç†**             | **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¤‰æ›´**                   |
| -------- | -------------- | --------------------------- | ----------------------------------------- | -------------------------- | -------------------------------------- |
| **1**    | ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ | `signage-connect` é€ä¿¡      | `{ theaterId: "1" }`                      | ã‚µãƒ¼ãƒãƒ¼ãŒ theaterId è¨˜éŒ²  | `socketId`, `isConnected: true`        |
| **2**    | ã‚µãƒ¼ãƒãƒ¼       | `connection-confirmed` é€ä¿¡ | `{ message, theaterId }`                  | ã‚µã‚¤ãƒãƒ¼ã‚¸ãŒæ¥ç¶šç¢ºèª       | -                                      |
| **3**    | ç®¡ç†ç”»é¢       | æ˜ ç”»è¨­å®šå¤‰æ›´ API å®Ÿè¡Œ       | `{ movieId, titleOverride, showingType }` | API å‡¦ç†é–‹å§‹               | -                                      |
| **4**    | ã‚µãƒ¼ãƒãƒ¼(API)  | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°            | è¨­å®šãƒ‡ãƒ¼ã‚¿                                | SignageStatus æ›´æ–°         | æ˜ ç”»ãƒ»è¨­å®šãƒ‡ãƒ¼ã‚¿æ›´æ–°                   |
| **5**    | ã‚µãƒ¼ãƒãƒ¼(API)  | `signage-data-updated` é€ä¿¡ | æ›´æ–°æ¸ˆã¿ã‚µã‚¤ãƒãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿                  | å¯¾è±¡ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ã¿å—ä¿¡     | -                                      |
| **6**    | ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ | SWR ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°          | æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿                              | ç”»é¢å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°         | -                                      |
| **7**    | ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ | åˆ‡æ–­æ™‚å‡¦ç†                  | -                                         | ã‚µãƒ¼ãƒãƒ¼ãŒ disconnect æ¤œçŸ¥ | `socketId: null`, `isConnected: false` |

### æ¥ç¶šãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†

#### æ¥ç¶šæ™‚ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

```
ã‚µã‚¤ãƒãƒ¼ã‚¸èµ·å‹•
    â†“
Socket.IOæ¥ç¶šé–‹å§‹
    â†“
signage-connect(theaterId)é€ä¿¡
    â†“
ã‚µãƒ¼ãƒãƒ¼ãŒDBæ›´æ–°(socketIdä¿å­˜, isConnected: true)
    â†“
connection-confirmedå—ä¿¡
    â†“
æ¥ç¶šçŠ¶æ…‹è¡¨ç¤º: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³(ç·‘)
```

#### æ›´æ–°æ™‚ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

```
ç®¡ç†ç”»é¢ã§æ˜ ç”»å¤‰æ›´
    â†“
API PATCH /signages/:id
    â†“
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
    â†“
Socket.IOé€šçŸ¥é€ä¿¡(è©²å½“ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ã¿)
    â†“
ã‚µã‚¤ãƒãƒ¼ã‚¸ã§signage-data-updatedå—ä¿¡
    â†“
SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
    â†“
ç”»é¢ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
```

#### åˆ‡æ–­æ™‚ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

```
ã‚µã‚¤ãƒãƒ¼ã‚¸é–‰ã˜ã‚‹/ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­
    â†“
Socket.IO disconnectæ¤œçŸ¥
    â†“
ã‚µãƒ¼ãƒãƒ¼ãŒDBæ›´æ–°(socketId: null, isConnected: false)
    â†“
æ¥ç¶šçŠ¶æ…‹è¡¨ç¤º: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³(èµ¤)
```

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã®ç‰¹å¾´

#### âœ… å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

- **å€‹åˆ¥é€šä¿¡**: ç‰¹å®šã®ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ã¿ã«é€šçŸ¥é€ä¿¡
- **æ¥ç¶šçŠ¶æ…‹ç®¡ç†**: DB ã§ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç®¡ç†
- **è‡ªå‹•å†æ¥ç¶š**: Socket.IO æ¨™æº–æ©Ÿèƒ½ã§æ¥ç¶šæ–­çµ¶æ™‚è‡ªå‹•å¾©æ—§
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: æ¥ç¶šå¤±æ•—ãƒ»æ›´æ–°å¤±æ•—ã®é©åˆ‡ãªå‡¦ç†

#### ğŸ”§ æŠ€è¡“ä»•æ§˜

- **ãƒ—ãƒ­ãƒˆã‚³ãƒ«**: WebSocket (ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: HTTP Long Polling)
- **èªè¨¼**: ãªã— (ã‚·ãƒ³ãƒ—ãƒ«ãª theaterId è­˜åˆ¥)
- **é€šä¿¡ç¯„å›²**: åŒä¸€ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ã¿ (ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆãªã—)
- **ãƒ‡ãƒ¼ã‚¿å½¢å¼**: JSON

#### ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- **ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“**: æ•°ãƒŸãƒªç§’ (WebSocket ç›´æ¥é€šä¿¡)
- **ãƒãƒ¼ãƒªãƒ³ã‚°å‰Šæ¸›**: æ¥ç¶šæ™‚ã¯ 5 ç§’é–“éš”ãƒãƒ¼ãƒªãƒ³ã‚°åœæ­¢
- **å¸¯åŸŸå¹…å‰Šæ¸›**: å¤‰æ›´æ™‚ã®ã¿ãƒ‡ãƒ¼ã‚¿é€ä¿¡

#### ğŸ¯ é‹ç”¨ä¸Šã®åˆ©ç‚¹

| **å¾“æ¥ (ãƒãƒ¼ãƒªãƒ³ã‚°)**  | **ç¾åœ¨ (Socket.IO)** |
| ---------------------- | -------------------- |
| 5 ç§’é–“éš”ã§å…¨ãƒ‡ãƒ¼ã‚¿å–å¾— | å¤‰æ›´æ™‚ã®ã¿é€šçŸ¥       |
| ç„¡é§„ãªé€šä¿¡å¤šæ•°         | å¿…è¦æœ€å°é™ã®é€šä¿¡     |
| æœ€å¤§ 5 ç§’ã®é…å»¶        | ã»ã¼ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ      |
| ã‚µãƒ¼ãƒãƒ¼è² è·é«˜         | ã‚µãƒ¼ãƒãƒ¼è² è·è»½æ¸›     |

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ è©³ç´°

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (`/frontend`)

```
src/
â”œâ”€â”€ components/           # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ movie/           # æ˜ ç”»é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ movieDetailsDialog/    # æ˜ ç”»è©³ç´°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”œâ”€â”€ movieRegistrationForm/ # æ˜ ç”»ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”œâ”€â”€ movieSelectionList/    # æ˜ ç”»é¸æŠãƒªã‚¹ãƒˆ
â”‚   â”œâ”€â”€ schedulePanel/     # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‘ãƒãƒ«
â”‚   â”œâ”€â”€ signageDetailsDialog/  # ã‚µã‚¤ãƒãƒ¼ã‚¸è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”œâ”€â”€ signageListItem/   # ã‚µã‚¤ãƒãƒ¼ã‚¸ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ 
â”‚   â””â”€â”€ topbar/           # ãƒˆãƒƒãƒ—ãƒãƒ¼
â”œâ”€â”€ hooks/               # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”œâ”€â”€ pages/               # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ home/            # ãƒ›ãƒ¼ãƒ ç”»é¢
â”‚   â”œâ”€â”€ loading/         # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢
â”‚   â”œâ”€â”€ login/           # ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
â”‚   â”œâ”€â”€ movieList/       # æ˜ ç”»ä¸€è¦§ç”»é¢
â”‚   â”œâ”€â”€ register/        # ç™»éŒ²ç”»é¢
â”‚   â”œâ”€â”€ schedules/       # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç”»é¢
â”‚   â”œâ”€â”€ signage/         # ã‚µã‚¤ãƒãƒ¼ã‚¸è¡¨ç¤ºç”»é¢
â”‚   â””â”€â”€ signageManager/  # ã‚µã‚¤ãƒãƒ¼ã‚¸ç®¡ç†ç”»é¢
â”œâ”€â”€ assets/              # é™çš„ãƒªã‚½ãƒ¼ã‚¹
â”œâ”€â”€ App.jsx              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ firebase.js          # Firebaseè¨­å®š
â””â”€â”€ main.jsx            # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (`/backend`)

```
â”œâ”€â”€ config/              # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ db.js           # MongoDBæ¥ç¶šè¨­å®š
â”‚   â”œâ”€â”€ firebaseAdmin.js # Firebase Adminè¨­å®š
â”‚   â””â”€â”€ serviceAccountKey.json # Firebaseèªè¨¼ã‚­ãƒ¼
â”œâ”€â”€ models/              # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ Movie.js        # æ˜ ç”»ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ SignageStatus.js # ã‚µã‚¤ãƒãƒ¼ã‚¸ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ TheaterSchedule.js # ã‚·ã‚¢ã‚¿ãƒ¼ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ¢ãƒ‡ãƒ«
â”‚   â””â”€â”€ User.js         # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«
â”œâ”€â”€ routes/              # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ auth.js         # èªè¨¼é–¢é€£API
â”‚   â”œâ”€â”€ middleware.js   # ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”œâ”€â”€ movies.js       # æ˜ ç”»é–¢é€£API
â”‚   â”œâ”€â”€ schedules.js    # ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é–¢é€£API
â”‚   â”œâ”€â”€ signage.js      # ã‚µã‚¤ãƒãƒ¼ã‚¸é–¢é€£API
â”‚   â””â”€â”€ users.js        # ãƒ¦ãƒ¼ã‚¶ãƒ¼é–¢é€£API
â””â”€â”€ server.js           # ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
```

## ğŸ”Œ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### æ˜ ç”»ç®¡ç†

- `GET /api/movies` - æ˜ ç”»ä¸€è¦§å–å¾—ï¼ˆãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰
- `POST /api/movies` - æ˜ ç”»ç™»éŒ²
- `GET /api/movies/:id` - ç‰¹å®šæ˜ ç”»å–å¾—
- `PATCH /api/movies/:id` - æ˜ ç”»æ›´æ–°
- `DELETE /api/movies/:id` - æ˜ ç”»å‰Šé™¤

### ã‚µã‚¤ãƒãƒ¼ã‚¸ç®¡ç†

- `GET /api/signages` - ã‚µã‚¤ãƒãƒ¼ã‚¸ä¸€è¦§å–å¾—
- `GET /api/signages/:id` - ç‰¹å®šã‚µã‚¤ãƒãƒ¼ã‚¸å–å¾—
- `PATCH /api/signages/:id` - ã‚µã‚¤ãƒãƒ¼ã‚¸æ›´æ–°ï¼ˆSocket.IO é€šçŸ¥ä»˜ãï¼‰
- `DELETE /api/signages/:id` - ã‚µã‚¤ãƒãƒ¼ã‚¸å‰Šé™¤

### èªè¨¼

- `POST /api/auth/login` - ãƒ­ã‚°ã‚¤ãƒ³
- `POST /api/auth/logout` - ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
- `GET /api/auth/verify` - ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼

## ğŸ¨ ç”»é¢æ§‹æˆ

### 1. æ˜ ç”»ç®¡ç†ç”»é¢ (`/movieList`)

- æ˜ ç”»ã®ä¸€è¦§è¡¨ç¤ºãƒ»æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- æ–°è¦æ˜ ç”»ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 
- ãƒªã‚¹ãƒˆè¡¨ç¤ºãƒ»ãƒã‚¹ã‚¿ãƒ¼è¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ

### 2. ã‚µã‚¤ãƒãƒ¼ã‚¸ç®¡ç†ç”»é¢ (`/signageManager`)

- å…¨ã‚µã‚¤ãƒãƒ¼ã‚¸ã®ä¸€è¦§è¡¨ç¤º
- æ¥ç¶šçŠ¶æ…‹ã®å¯è¦–åŒ–
- å„ã‚µã‚¤ãƒãƒ¼ã‚¸ã®è¨­å®šå¤‰æ›´

### 3. ã‚µã‚¤ãƒãƒ¼ã‚¸è¡¨ç¤ºç”»é¢ (`/signage/:id`)

- æ˜ ç”»ãƒã‚¹ã‚¿ãƒ¼ã®å…¨ç”»é¢è¡¨ç¤º
- ä¸Šæ˜ ç¨®åˆ¥ã®è¡¨ç¤º
- ã‚¿ã‚¤ãƒˆãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰å¯¾å¿œ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æ©Ÿèƒ½

### 4. èªè¨¼ç”»é¢

- Firebase èªè¨¼ã«ã‚ˆã‚‹ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ç™»éŒ²
- ã‚»ã‚­ãƒ¥ã‚¢ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

## ğŸ”§ é–‹ç™ºãƒ»é‹ç”¨

### é–‹ç™ºãƒ¢ãƒ¼ãƒ‰èµ·å‹•

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
cd backend
npm run dev

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
cd frontend
npm run dev
```

### ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰

```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
cd frontend
npm run build

# ãƒ“ãƒ«ãƒ‰çµæœç¢ºèª
npm run preview
```

### ç’°å¢ƒå¤‰æ•°

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (`.env`)

```
PORT=5000
MONGODB_URI=mongodb://localhost:27017/theater_signage
JWT_SECRET=your_jwt_secret_key
FIREBASE_TYPE=service_account
FIREBASE_PROJECT_ID=your_project_id
# ãã®ä»–Firebaseè¨­å®š...
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (`firebase.js`)

```javascript
const firebaseConfig = {
  apiKey: "your_api_key",
  authDomain: "your_auth_domain",
  projectId: "your_project_id",
  // ãã®ä»–Firebaseè¨­å®š...
};
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

### Movies Collection

| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å** | **ãƒ‡ãƒ¼ã‚¿å‹** | **å¿…é ˆ** | **èª¬æ˜**               | **ä¾‹**                          |
| ---------------- | ------------ | -------- | ---------------------- | ------------------------------- |
| `_id`            | ObjectId     | Yes      | MongoDB è‡ªå‹•ç”Ÿæˆ ID    | `507f1f77bcf86cd799439011`      |
| `title`          | String       | Yes      | æ˜ ç”»ã‚¿ã‚¤ãƒˆãƒ«           | `"ã‚¢ãƒ™ãƒ³ã‚¸ãƒ£ãƒ¼ã‚º/ã‚¨ãƒ³ãƒ‰ã‚²ãƒ¼ãƒ "` |
| `rating`         | String       | No       | ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°           | `"PG-12"`, `"R-15+"`, `"G"`     |
| `duration`       | Number       | No       | ä¸Šæ˜ æ™‚é–“ï¼ˆåˆ†ï¼‰         | `181`                           |
| `genre`          | String       | No       | ã‚¸ãƒ£ãƒ³ãƒ«               | `"ã‚¢ã‚¯ã‚·ãƒ§ãƒ³/SF"`               |
| `releaseDate`    | Date         | No       | å…¬é–‹æ—¥                 | `2019-04-26T00:00:00.000Z`      |
| `endDate`        | Date         | No       | ä¸Šæ˜ çµ‚äº†æ—¥             | `2019-07-26T00:00:00.000Z`      |
| `image`          | String       | No       | ãƒã‚¹ã‚¿ãƒ¼ç”»åƒï¼ˆBase64ï¼‰ | `"iVBORw0KGgoAAAANSUhEUgAA..."` |
| `description`    | String       | No       | èª¬æ˜ãƒ»ã‚ã‚‰ã™ã˜         | `"æœ€å¼·ã®ãƒ’ãƒ¼ãƒ­ãƒ¼ãŸã¡ãŒ..."`     |
| `createdAt`      | Date         | Yes      | ä½œæˆæ—¥æ™‚               | `2024-01-01T00:00:00.000Z`      |
| `updatedAt`      | Date         | Yes      | æ›´æ–°æ—¥æ™‚               | `2024-01-02T00:00:00.000Z`      |

### SignageStatus Collection

| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å** | **ãƒ‡ãƒ¼ã‚¿å‹** | **å¿…é ˆ** | **èª¬æ˜**            | **ä¾‹**                       |
| ---------------- | ------------ | -------- | ------------------- | ---------------------------- |
| `_id`            | ObjectId     | Yes      | MongoDB è‡ªå‹•ç”Ÿæˆ ID | `507f1f77bcf86cd799439012`   |
| `theaterId`      | String       | Yes      | ã‚·ã‚¢ã‚¿ãƒ¼è­˜åˆ¥ ID     | `"1"`, `"2"`, `"A"`          |
| `socketId`       | String       | No       | Socket.IO æ¥ç¶š ID   | `"abc123def456"`             |
| `isConnected`    | Boolean      | Yes      | æ¥ç¶šçŠ¶æ…‹ãƒ•ãƒ©ã‚°      | `true`, `false`              |
| `movieId`        | String       | No       | è¡¨ç¤ºä¸­æ˜ ç”»ã® ID     | `"507f1f77bcf86cd799439011"` |
| `titleOverride`  | String       | No       | ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¤ãƒˆãƒ«    | `"ç‰¹åˆ¥å…ˆè¡Œä¸Šæ˜ "`             |
| `description`    | String       | No       | ã‚µã‚¤ãƒãƒ¼ã‚¸èª¬æ˜      | `"1ç•ªã‚¹ã‚¯ãƒªãƒ¼ãƒ³ç”¨"`          |
| `showingType`    | Object       | Yes      | ä¸Šæ˜ ç¨®åˆ¥è¨­å®š        | ä¸‹è¨˜å‚ç…§                     |
| `createdAt`      | Date         | Yes      | ä½œæˆæ—¥æ™‚            | `2024-01-01T00:00:00.000Z`   |
| `updatedAt`      | Date         | Yes      | æ›´æ–°æ—¥æ™‚            | `2024-01-02T00:00:00.000Z`   |

### ShowingType ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°

| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å** | **ãƒ‡ãƒ¼ã‚¿å‹** | **èª¬æ˜**           | **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤** |
| ---------------- | ------------ | ------------------ | ---------------- |
| `sub`            | Boolean      | å­—å¹•ç‰ˆ             | `false`          |
| `dub`            | Boolean      | å¹æ›¿ç‰ˆ             | `false`          |
| `jsub`           | Boolean      | æ—¥æœ¬èªå­—å¹•ç‰ˆ       | `false`          |
| `fourK`          | Boolean      | 4K ä¸Šæ˜             | `false`          |
| `threeD`         | Boolean      | 3D ä¸Šæ˜             | `false`          |
| `cheer`          | Boolean      | å¿œæ´ä¸Šæ˜            | `false`          |
| `live`           | Boolean      | ãƒ©ã‚¤ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚° | `false`          |
| `greeting`       | Boolean      | èˆå°æŒ¨æ‹¶           | `false`          |
| `greetingLive`   | Boolean      | èˆå°æŒ¨æ‹¶ä¸­ç¶™       | `false`          |

### Users Collection

| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å** | **ãƒ‡ãƒ¼ã‚¿å‹** | **å¿…é ˆ** | **èª¬æ˜**            | **ä¾‹**                            |
| ---------------- | ------------ | -------- | ------------------- | --------------------------------- |
| `_id`            | ObjectId     | Yes      | MongoDB è‡ªå‹•ç”Ÿæˆ ID | `507f1f77bcf86cd799439013`        |
| `uid`            | String       | Yes      | Firebase UID        | `"firebase_uid_string"`           |
| `email`          | String       | Yes      | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹      | `"admin@theater.com"`             |
| `displayName`    | String       | No       | è¡¨ç¤ºå              | `"ç®¡ç†è€…"`                        |
| `role`           | String       | Yes      | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™        | `"admin"`, `"manager"`, `"staff"` |
| `isActive`       | Boolean      | Yes      | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœ‰åŠ¹çŠ¶æ…‹  | `true`, `false`                   |
| `lastLoginAt`    | Date         | No       | æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³æ—¥æ™‚    | `2024-01-02T09:30:00.000Z`        |
| `createdAt`      | Date         | Yes      | ä½œæˆæ—¥æ™‚            | `2024-01-01T00:00:00.000Z`        |
| `updatedAt`      | Date         | Yes      | æ›´æ–°æ—¥æ™‚            | `2024-01-02T00:00:00.000Z`        |

### TheaterSchedule Collection

| **ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å** | **ãƒ‡ãƒ¼ã‚¿å‹** | **å¿…é ˆ** | **èª¬æ˜**            | **ä¾‹**                       |
| ---------------- | ------------ | -------- | ------------------- | ---------------------------- |
| `_id`            | ObjectId     | Yes      | MongoDB è‡ªå‹•ç”Ÿæˆ ID | `507f1f77bcf86cd799439014`   |
| `theaterId`      | String       | Yes      | ã‚·ã‚¢ã‚¿ãƒ¼è­˜åˆ¥ ID     | `"1"`, `"2"`, `"A"`          |
| `movieId`        | String       | Yes      | ä¸Šæ˜ æ˜ ç”»ã® ID       | `"507f1f77bcf86cd799439011"` |
| `startTime`      | Date         | Yes      | ä¸Šæ˜ é–‹å§‹æ™‚åˆ»        | `2024-01-02T14:30:00.000Z`   |
| `endTime`        | Date         | Yes      | ä¸Šæ˜ çµ‚äº†æ™‚åˆ»        | `2024-01-02T17:31:00.000Z`   |
| `ticketPrice`    | Number       | No       | ãƒã‚±ãƒƒãƒˆæ–™é‡‘        | `1800`                       |
| `availableSeats` | Number       | No       | åˆ©ç”¨å¯èƒ½åº§å¸­æ•°      | `120`                        |
| `showingType`    | Object       | No       | ä¸Šæ˜ ç¨®åˆ¥            | SignageStatus ã¨åŒã˜å½¢å¼     |
| `createdAt`      | Date         | Yes      | ä½œæˆæ—¥æ™‚            | `2024-01-01T00:00:00.000Z`   |
| `updatedAt`      | Date         | Yes      | æ›´æ–°æ—¥æ™‚            | `2024-01-02T00:00:00.000Z`   |

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£æ€§

```mermaid
erDiagram
    Movies ||--o{ SignageStatus : "movieId"
    Movies ||--o{ TheaterSchedule : "movieId"
    SignageStatus ||--o{ TheaterSchedule : "theaterId"
    Users ||--o{ Movies : "created_by"

    Movies {
        ObjectId _id PK
        String title
        String rating
        Number duration
        String genre
        Date releaseDate
        Date endDate
        String image
        String description
    }

    SignageStatus {
        ObjectId _id PK
        String theaterId
        String socketId
        Boolean isConnected
        String movieId FK
        String titleOverride
        Object showingType
    }

    TheaterSchedule {
        ObjectId _id PK
        String theaterId
        String movieId FK
        Date startTime
        Date endTime
        Number ticketPrice
        Number availableSeats
        Object showingType
    }

    Users {
        ObjectId _id PK
        String uid
        String email
        String displayName
        String role
        Boolean isActive
    }
```

showingType: { // ä¸Šæ˜ ç¨®åˆ¥
sub: Boolean, // å­—å¹•ç‰ˆ
dub: Boolean, // å¹æ›¿ç‰ˆ
jsub: Boolean, // æ—¥æœ¬èªå­—å¹•ç‰ˆ
fourK: Boolean, // 4K ä¸Šæ˜ 
threeD: Boolean, // 3D ä¸Šæ˜ 
cheer: Boolean, // å¿œæ´ä¸Šæ˜ 
live: Boolean, // ãƒ©ã‚¤ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°
greeting: Boolean, // èˆå°æŒ¨æ‹¶
greetingLive: Boolean // èˆå°æŒ¨æ‹¶ä¸­ç¶™
}
}

```

## ğŸ‘¨â€ğŸ’» é–‹ç™ºè€…

- **nas-onima** - _Initial work_ - [GitHub](https://github.com/nas-onima)


**æ›´æ–°æ—¥**: 2025å¹´10æœˆ4æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**Node.js**: v16ä»¥ä¸Šæ¨å¥¨
**MongoDB**: v4.4ä»¥ä¸Šæ¨å¥¨
```
